<!doctype html>
<html lang="ko"><head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>입력 — 펀치머신</title>
<style>
  body{margin:0;background:#0b1023;color:#e5e7eb;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR','Malgun Gothic',sans-serif;display:grid;place-items:center;min-height:100vh}
  .wrap{width:100%;max-width:520px;padding:20px}
  .card{background:#0f172a;border:1px solid #233052;border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  h1{margin:0 0 12px;font-size:22px;letter-spacing:-.02em}
  label{display:block;font-size:13px;color:#cbd5e1;margin:8px 0 6px}
  input{width:100%;background:#0b1021;border:1px solid #233052;border-radius:12px;padding:14px;color:#e5e7eb;font-size:18px}
  input:focus{outline:none;box-shadow:0 0 0 4px rgba(34,211,238,.12);border-color:#22d3ee}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  button{width:100%;margin-top:14px;padding:14px;border-radius:12px;border:1px solid #1fbdd1;background:linear-gradient(180deg,#11a0b4,#0f8ea6);color:#001018;font-weight:800;font-size:18px}
  .muted{color:#94a3b8;font-size:12px;margin-top:8px}
  .ok{color:#34d399}.err{color:#f87171}
</style>
</head><body>
<div class="wrap">
  <div class="card">
    <h1>펀치머신 점수 입력</h1>
    <label>이름</label>
    <input id="name" placeholder="예: 김펀치" autocomplete="name"/>
    <div class="row">
      <div>
        <label>전화번호(끝 4자리만 공개)</label>
        <input id="phone" inputmode="numeric" pattern="[0-9\-\s]{8,}" placeholder="예: 01012345678"/>
      </div>
      <div>
        <label>점수</label>
        <input id="score" type="number" inputmode="numeric" min="0" max="999999" placeholder="0"/>
      </div>
    </div>
    <label>진행요원 PIN</label>
    <input id="pin" inputmode="numeric" placeholder="현장 전용"/>
    <button id="submit">기록 저장(Enter)</button>
    <div id="msg" class="muted"></div>
  </div>
</div>
<script>
const GAS_URL = 'https://script.google.com/macros/s/AKfycbyKiqbUe7jJY5iZpjt6Deq17jHhMlYjUgGL6D_Jz2_p4JPgoDXuMJ5fUSI3wZDFuWwZBQ/exec'; // /exec 최신 배포 URL

async function sendForm(data){
  // 프리플라이트 방지: 헤더 없음 + urlencoded 바디
  const body = new URLSearchParams(data);
  const res = await fetch(GAS_URL, { method:'POST', body });  // 헤더 금지
  // GAS는 JSON을 주지만, 일부 환경에서 CORS로 body 접근이 막히는 경우도 있으니
  // 응답을 굳이 읽지 않아도 동작하게 UI 처리:
  if (!res.ok) throw new Error('서버 응답 오류: ' + res.status);
  return true;
}

document.getElementById('scoreForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const f = e.target;
  const data = {
    name: f.name.value.trim() || '익명',
    score: Math.floor(Number(f.score.value || 0)),
    phone: (f.phoneLast4?.value?.trim()?.length === 4) ? f.phoneLast4.value : (f.phone?.value || ''),
    pin: (f.pin?.value || '')
  };
  try {
    await sendForm(data);
    alert('전송 완료');
    f.reset();
  } catch (err) {
    alert('전송 실패: ' + err.message);
  }
});
</script>

</body></html>
